<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <p id="showResult"></p>
    <button onclick="showRowCnt()">보여줘.</button><br>

    <input type="text" id="id">
    <input type="text" id="first_name">
    <input type="text" id="last_name">
    <button id="update">변경</button>

    <script>
        let data = [{
                "id": 1,
                "first_name": "Ware",
                "last_name": "Somerscales",
                "email": "wsomerscales0@elpais.com",
                "gender": "Male",
                "ip_address": "62.229.73.227"
            },
            {
                "id": 2,
                "first_name": "Nikita",
                "last_name": "Brabin",
                "email": "nbrabin1@vk.com",
                "gender": "Male",
                "ip_address": "233.71.179.161"
            },
            {
                "id": 3,
                "first_name": "Rhody",
                "last_name": "Mossop",
                "email": "rmossop2@va.gov",
                "gender": "Female",
                "ip_address": "134.43.224.222"
            },
            {
                "id": 4,
                "first_name": "Carmencita",
                "last_name": "Fahrenbach",
                "email": "cfahrenbach3@artisteer.com",
                "gender": "Female",
                "ip_address": "132.160.202.169"
            },
            {
                "id": 5,
                "first_name": "Wandis",
                "last_name": "Haggarth",
                "email": "whaggarth4@mediafire.com",
                "gender": "Female",
                "ip_address": "82.151.159.122"
            },
            {
                "id": 6,
                "first_name": "Virgina",
                "last_name": "Wyse",
                "email": "vwyse5@cbslocal.com",
                "gender": "Female",
                "ip_address": "229.150.216.236"
            },
            {
                "id": 7,
                "first_name": "Manolo",
                "last_name": "Kemmer",
                "email": "mkemmer6@adobe.com",
                "gender": "Male",
                "ip_address": "43.0.148.244"
            },
            {
                "id": 8,
                "first_name": "Dorolisa",
                "last_name": "Dougal",
                "email": "ddougal7@slashdot.org",
                "gender": "Female",
                "ip_address": "208.126.65.200"
            },
            {
                "id": 9,
                "first_name": "Storm",
                "last_name": "Boyn",
                "email": "sboyn8@yelp.com",
                "gender": "Female",
                "ip_address": "166.170.198.41"
            },
            {
                "id": 10,
                "first_name": "Mac",
                "last_name": "Kempton",
                "email": "mkempton9@prnewswire.com",
                "gender": "Male",
                "ip_address": "235.15.16.198"
            },
            {
                "id": 11,
                "first_name": "Rebecka",
                "last_name": "Bruyns",
                "email": "rbruynsa@yandex.ru",
                "gender": "Female",
                "ip_address": "82.86.84.43"
            },
            {
                "id": 12,
                "first_name": "Tiphanie",
                "last_name": "Suggey",
                "email": "tsuggeyb@artisteer.com",
                "gender": "Female",
                "ip_address": "80.248.176.41"
            },
            {
                "id": 13,
                "first_name": "Duffy",
                "last_name": "Farrall",
                "email": "dfarrallc@rambler.ru",
                "gender": "Male",
                "ip_address": "101.48.250.41"
            },
            {
                "id": 14,
                "first_name": "Cecilio",
                "last_name": "Dinse",
                "email": "cdinsed@flickr.com",
                "gender": "Male",
                "ip_address": "214.244.66.131"
            },
            {
                "id": 15,
                "first_name": "Olympie",
                "last_name": "Rey",
                "email": "oreye@infoseek.co.jp",
                "gender": "Female",
                "ip_address": "53.226.182.26"
            },
            {
                "id": 16,
                "first_name": "Marla",
                "last_name": "Skipsey",
                "email": "mskipseyf@ebay.com",
                "gender": "Female",
                "ip_address": "72.21.127.134"
            },
            {
                "id": 17,
                "first_name": "Sherri",
                "last_name": "Jupp",
                "email": "sjuppg@amazon.co.uk",
                "gender": "Female",
                "ip_address": "73.9.68.130"
            },
            {
                "id": 18,
                "first_name": "Christine",
                "last_name": "Shedd",
                "email": "csheddh@sina.com.cn",
                "gender": "Female",
                "ip_address": "174.181.115.84"
            },
            {
                "id": 19,
                "first_name": "Van",
                "last_name": "Twoohy",
                "email": "vtwoohyi@cmu.edu",
                "gender": "Female",
                "ip_address": "4.108.189.147"
            },
            {
                "id": 20,
                "first_name": "Corenda",
                "last_name": "Kearney",
                "email": "ckearneyj@tripod.com",
                "gender": "Female",
                "ip_address": "8.246.8.169"
            }
        ]; //data 끝
        for (let i = 0; i < 10; i++) {
            data.pop();
        }
        //console.log(data)

        for (let i = 0; i < data.length; i++) {
            //console.log(data[i].first_name);
        }
        // in은 오브젝트 안에 필드값 가져올 때 / of는 배열에 있는 요소를 가져올 때
        for (let field in data[19]) {
            //console.log(field, data[19][field]) // 필드이름과 값을 가져옴 data[19].field 는 불가능
        }

        for (let datam of data) {
            //console.log(datam)
        }

        let fields = ["id", "first_name", "last_name", "email", "gender","button"];
        let table, tr, td, text;
        table = document.createElement("table");
        table.setAttribute('border', '1');

        //필드..
        tr = document.createElement("tr");
        table.appendChild(tr);
        for (let title of fields) {
            td = document.createElement("th");
            text = document.createTextNode(title.replace("_", "").toUpperCase());
            td.appendChild(text);
            tr.appendChild(td);
        }

        data.forEach(function (obj, idx, ary) {
            tr = document.createElement("tr");
            tr.addEventListener("mouseover", function () {
                this.style.background = "yellow";
            })

            tr.addEventListener("mouseout", function () {
                this.style.background = "";
            })

            tr.addEventListener("click", function () {
                localStorage.setItem("rowNum", idx); //rowNum에 idx값을 setItem 함수써서 담음
                localStorage.setItem("first_name", this.childNodes[1].firstChild.nodeValue);
                localStorage.setItem("last_name", this.childNodes[2].firstChild.nodeValue);
                localStorage.setItem("email", this.childNodes[3].firstChild.nodeValue);

            })
            //여기부터

            tr.addEventListener("click", function () {
                console.log(this.childNodes[1].firstChild.nodeValue);
            });

            for (let field of fields) { //in은 필드값 가져올떄!
                if (field === 'button') {
                    td = document.createElement("td");
                    let btn = document.createElement("button");
                    btn.innerHTML = "수정";
                    td.appendChild(btn);
                    tr.appendChild(td);
                    btn.onclick = function () {
                        console.log(this.parentNode.parentNode.childNodes[0].firstChild.nodeValue);
                        let id = this.parentNode.parentNode.childNodes[0].firstChild.nodeValue;
                        let fName = this.parentNode.parentNode.childNodes[1].firstChild.nodeValue;
                        let lName = this.parentNode.parentNode.childNodes[2].firstChild.nodeValue;
                        let email = this.parentNode.parentNode.childNodes[3].firstChild.nodeValue;
                        let gender = this.parentNode.parentNode.childNodes[4].firstChild.nodeValue;

                        window.location.href = "jsonDetail.jsp?id=" + id + "&first_name=" + fName +
                            "&last_name=" + lName + "&email=" + email + "&gender=" + gender;
                    }
                } else {
                    console.log(obj[field]); // 필드
                    td = document.createElement("td");
                    text = document.createTextNode(obj[field]);
                    td.appendChild(text);
                    tr.appendChild(td);
                }

            }


            table.appendChild(tr);
            //console.log(obj["first_name"]); // first_name의 값을 가져옴
        });
        document.getElementById("showResult").appendChild(table);

        function showRowCnt() {
            console.log(localStorage.getItem("email"));

            data.forEach(function (obj, idx, ary) {
                if (document.getElementById("id").value * 1 == (idx + 1)) {
                    document.getElementById("first_name").value = obj.first_name;
                    document.getElementById("last_name").value = obj.last_name;
                }
            });

        }
    </script>

</body>

</html>